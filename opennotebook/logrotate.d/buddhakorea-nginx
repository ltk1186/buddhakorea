# Logrotate configuration for Buddha Korea Nginx logs
# Install to: /etc/logrotate.d/buddhakorea-nginx

/var/log/nginx/access.log /var/log/nginx/error.log {
    daily
    rotate 14
    missingok
    notifempty
    compress
    delaycompress

    # Use copytruncate for Docker-based nginx
    copytruncate

    # Anonymize IPs in access logs before rotation
    prerotate
        # IP anonymization is handled by nginx config (real_ip_header X-Forwarded-For)
        # No action needed here
    endscript

    # Signal nginx to reopen log files (if not using copytruncate)
    # postrotate
    #     docker kill --signal=USR1 buddhakorea-nginx 2>/dev/null || true
    # endscript
}
