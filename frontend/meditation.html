<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self';
                   style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net;
                   font-src 'self' https://cdn.jsdelivr.net;
                   script-src 'self';
                   img-src 'self' data:;
                   connect-src 'self';">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <title>λ…μƒ νƒ€μ΄λ¨Έ | Buddha Korea</title>
    <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/meditation.css">
    <style>
        /* Force Buddha tab spacing to match Tab 1 - inline to bypass cache */
        /* Tab 1 has: subtitle (30px) + guidance button padding (40px) + guidance margin (40px) = 110px total when closed */
        /* Tab 2 needs: subtitle (110px) to match Tab 1's collapsed guidance appearance */
        #screen-buddha-setup .subtitle {
            margin-bottom: 110px !important;
        }
    </style>
</head>
<body>
    <!-- μ ‘κ·Όμ„±: κ±΄λ„λ›°κΈ° λ§ν¬ -->
    <a href="#screen-setup" class="skip-link">λ…μƒ μ„¤μ •μΌλ΅ κ±΄λ„λ›°κΈ°</a>

    <!-- ν—¤λ” -->
    <header class="site-header">
        <div class="header-container">
            <a href="index.html" class="header-logo">
                <img src="assets/buddha-line.png" alt="Buddha Korea" class="logo-icon">
                <span class="logo-text">Buddha Korea</span>
            </a>
            <nav class="header-nav">
                <a href="index.html" class="nav-link">ν™</a>
                <div class="nav-dropdown">
                    <button class="nav-link dropdown-toggle" id="ai-nav-button">AI</button>
                    <div class="dropdown-menu">
                        <a href="https://notebooklm.google.com/notebook/1f5450ac-8ba6-4c30-b1ce-f63977dabfc1" target="_blank" class="dropdown-item">μ•„λΉ„λ‹΄λ§ AI</a>
                        <a href="https://notebooklm.google.com/notebook/18c4a48e-3225-4ddc-abe8-42515c19cbba" target="_blank" class="dropdown-item">μ²­μ •λ„λ΅  AI</a>
                        <a href="https://notebooklm.google.com/notebook/de2a2db1-e57e-428b-903b-43e75506833f" target="_blank" class="dropdown-item">μ΄κΈ°λ¶κµ AI</a>
                    </div>
                </div>
                <a href="pali/" class="nav-link">λΉ μ•λ¦¬</a>
                <a href="sutra-writing.html" class="nav-link">μ‚¬κ²½</a>
                <!-- Temporarily disabled navigation links -->
                <!-- <a href="meditation.html" class="nav-link">λ…μƒ</a> -->
                <!-- <a href="teaching.html" class="nav-link">κµν•™</a> -->
            </nav>
        </div>
    </header>
    <div class="header-spacer"></div>

    <!-- λ§μ°μ¤ λ”°λΌλ‹¤λ‹λ” λΉ› ν¨κ³Ό -->
    <div class="mouse-light"></div>

    <!-- λ©”μΈ μ»¨ν…μ΄λ„ -->
    <div class="meditation-page">

        <!-- Tab Navigation -->
        <nav class="meditation-tabs" role="tablist" aria-label="λ…μƒ μ ν• μ„ νƒ">
            <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="tab-breathing" data-tab="breathing" id="tab-btn-breathing">
                νΈν΅
            </button>
            <button class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-buddha" data-tab="buddha" id="tab-btn-buddha">
                λ¶μƒ κ΄€μƒ
            </button>
            <button class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-mandala" data-tab="mandala" id="tab-btn-mandala">
                λ§λ‹¬λΌ
            </button>
        </nav>

        <!-- Tab Panel: νΈν΅ (Breathing) -->
        <div id="tab-breathing" class="tab-panel active" role="tabpanel" aria-labelledby="tab-btn-breathing">
            <!-- 1. λ…μƒ μ„¤μ • ν™”λ©΄ -->
            <div id="screen-setup" class="screen center-content show">
            <div class="center-box">
                <h1>νΈν΅ νƒ€μ΄λ¨Έ</h1>
                <p class="subtitle">κ³ μ”ν μ•‰μ•„ λ§μμ„ κ΄€μ°°ν•λ” μν–‰</p>

                <!-- μν–‰ μ•λ‚΄ μ„Ήμ… (μ ‘μ΄μ‹) -->
                <div class="guidance-container">
                    <button class="guidance-toggle" aria-expanded="false" aria-controls="guidance-content" aria-label="νΈν΅ λ§μμ±™κΉ€ μν–‰ μ•λ‚΄ μ—΄κΈ°">
                        <span class="toggle-title">μν–‰ μ•λ‚΄</span>
                        <span class="toggle-icon" aria-hidden="true">β–Ό</span>
                    </button>

                    <div class="guidance-content closed" id="guidance-content">
                        <h3 class="guidance-title">νΈν΅ λ§μμ±™κΉ€ <span class="pali">(Δ€nΔpΔnassati)</span></h3>
                        <p class="guidance-intro">νΈν΅μ— λ€ν• λ§μμ±™κΉ€μ€ λΈ κ΄€μ°°μ ν• ν•νƒμ΄λ©°, κ°€μ¥ κΈ°λ³Έμ μ΄κ³  ν¨κ³Όμ μΈ λ…μƒ λ°©λ²•μ…λ‹λ‹¤.</p>

                        <div class="guidance-section">
                            <h4>μ¤€λΉ„</h4>
                            <p>μ΅°μ©ν• μ¥μ†μ—μ„ νΈμ•ν•κ² μ•‰μ•„ ν—λ¦¬λ¥Ό κ³§κ² μ„Έμ°κ³  μ •λ©΄μ„ ν–¥ν•΄ λ§μμ±™κΉ€μ„ ν™•λ¦½ν•©λ‹λ‹¤.</p>
                        </div>

                        <div class="guidance-section">
                            <h4>μν–‰ λ°©λ²•</h4>
                            <p>λ§μμ±™κΉ€ν•μ—¬ λ“¤μ΄μ‰¬κ³ , λ§μμ±™κΉ€ν•μ—¬ λ‚΄μ‰½λ‹λ‹¤.</p>
                        </div>

                        <div class="guidance-section">
                            <h4>κ΄€μ°°ν•κΈ°</h4>
                            <p>
                                κΈΈκ² λ“¤μ΄μ‰¬λ©΄ κΈΈκ² λ“¤μ΄μ‰°λ‹¤λ” κ²ƒμ„ μ•μ•„μ°¨λ¦½λ‹λ‹¤.<br>
                                κΈΈκ² λ‚΄μ‰¬λ©΄ κΈΈκ² λ‚΄μ‰°λ‹¤λ” κ²ƒμ„ μ•μ•„μ°¨λ¦½λ‹λ‹¤.<br>
                                μ§§κ² λ“¤μ΄μ‰¬κ³  λ‚΄μ‰¬λ” κ²ƒμ„ μ•μ•„μ°¨λ¦½λ‹λ‹¤.<br>
                                μ¨λΈμ„ κ²½ν—ν•λ©° λ“¤μ΄μ‰¬κ³  λ‚΄μ‰½λ‹λ‹¤.<br>
                                μ‹ μ²΄μ  μ‘μ©μ„ κ³ μ”ν ν•λ©° νΈν΅ν•©λ‹λ‹¤.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="duration-cards">
                    <div class="card" data-duration="10"
                         role="button" tabindex="0"
                         aria-label="10λ¶„ λ…μƒ μ‹μ‘">
                        <h2>10λ¶„</h2>
                        <p>μ§§μ€ μν–‰</p>
                    </div>
                    <div class="card" data-duration="20"
                         role="button" tabindex="0"
                         aria-label="20λ¶„ λ…μƒ μ‹μ‘">
                        <h2>20λ¶„</h2>
                        <p>κΈ°λ³Έ μν–‰</p>
                    </div>
                    <div class="card" data-duration="30"
                         role="button" tabindex="0"
                         aria-label="30λ¶„ λ…μƒ μ‹μ‘">
                        <h2>30λ¶„</h2>
                        <p>κΉμ€ μν–‰</p>
                    </div>
                </div>

                <div class="custom-duration">
                    <label for="custom-minutes">λ§μ¶¤ μ‹κ°„ (λ¶„)</label>
                    <input type="number" id="custom-minutes" min="1" max="120" placeholder="" aria-label="λ§μ¶¤ λ…μƒ μ‹κ°„ μ…λ ¥">
                    <button id="custom-start-btn" aria-label="λ§μ¶¤ μ‹κ°„μΌλ΅ λ…μƒ μ‹μ‘">μ‹μ‘</button>
                </div>
            </div>
        </div>

        <!-- 2. λ…μƒ μ§„ν–‰ ν™”λ©΄ -->
        <div id="screen-meditation" class="screen top-align">
            <div class="meditation-container">
                <button class="back-btn" id="stop-btn" aria-label="λ…μƒ μ¤‘λ‹¨ν•κ³  μ„¤μ •μΌλ΅ λμ•„κ°€κΈ°">μ¤‘λ‹¨</button>

                <!-- νΈν΅ μ› -->
                <div class="breathing-circle" role="region" aria-label="λ…μƒ μ§„ν–‰ ν‘μ‹">
                    <svg class="progress-ring" viewBox="0 0 300 300" width="300" height="300" preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <linearGradient id="breathing-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#89b8ff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#9bebb4;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <circle class="progress-ring-bg" cx="150" cy="150" r="140" />
                        <circle class="progress-ring-circle" cx="150" cy="150" r="140" />
                    </svg>
                    <div class="time-display" aria-live="polite" aria-atomic="true">
                        <span id="time-remaining">00:00</span>
                    </div>
                </div>

                <p class="meditation-instruction">νΈν΅μ„ κ΄€μ°°ν•μ„Έμ”</p>
            </div>
        </div>

        <!-- 3. λ…μƒ μ™„λ£ ν™”λ©΄ -->
        <div id="screen-complete" class="screen center-content">
            <div class="center-box">
                <div class="completion-icon">
                    <div class="glow"></div>
                    <div class="lotus">π·</div>
                </div>
                <h2 class="completion-text">λ…μƒ μ™„λ£</h2>
                <p class="completion-msg">κ³ μ”ν• λ§μμΌλ΅ λμ•„κ°‘λ‹λ‹¤</p>
                <button class="primary-btn" id="return-btn">λ‹¤μ‹ μ‹μ‘</button>
            </div>
        </div>
        </div>
        <!-- End Tab Panel: νΈν΅ -->

        <!-- Tab Panel: λ¶μƒ κ΄€μƒ (Buddha Contemplation) -->
        <div id="tab-buddha" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-buddha">
            <!-- 1. Buddha μ„¤μ • ν™”λ©΄ -->
            <div id="screen-buddha-setup" class="screen center-content show">
                <div class="center-box">
                    <h1>λ¶μƒ κ΄€μƒ</h1>
                    <p class="subtitle">λ¶μƒμ„ λ°”λΌλ³΄λ©° λ¬΄μƒν•¨μ„ κ΄€μ°°ν•μ„Έμ”</p>

                    <div class="duration-cards">
                        <div class="card" data-duration="10" data-type="buddha"
                             role="button" tabindex="0"
                             aria-label="10λ¶„ λ¶μƒ κ΄€μƒ μ‹μ‘">
                            <h2>10λ¶„</h2>
                            <p>μ§§μ€ κ΄€μƒ</p>
                        </div>
                        <div class="card" data-duration="20" data-type="buddha"
                             role="button" tabindex="0"
                             aria-label="20λ¶„ λ¶μƒ κ΄€μƒ μ‹μ‘">
                            <h2>20λ¶„</h2>
                            <p>κΈ°λ³Έ κ΄€μƒ</p>
                        </div>
                        <div class="card" data-duration="30" data-type="buddha"
                             role="button" tabindex="0"
                             aria-label="30λ¶„ λ¶μƒ κ΄€μƒ μ‹μ‘">
                            <h2>30λ¶„</h2>
                            <p>κΉμ€ κ΄€μƒ</p>
                        </div>
                    </div>

                    <div class="custom-duration">
                        <label for="custom-minutes-buddha">λ§μ¶¤ μ‹κ°„ (λ¶„)</label>
                        <input type="number" id="custom-minutes-buddha" min="1" max="120" placeholder="" aria-label="λ§μ¶¤ κ΄€μƒ μ‹κ°„ μ…λ ¥">
                        <button id="custom-start-btn-buddha" aria-label="λ§μ¶¤ μ‹κ°„μΌλ΅ λ¶μƒ κ΄€μƒ μ‹μ‘">μ‹μ‘</button>
                    </div>
                </div>
            </div>

            <!-- 2. Buddha λ…μƒ μ§„ν–‰ ν™”λ©΄ -->
            <div id="screen-buddha-meditation" class="screen top-align">
                <div class="meditation-container">
                    <button class="back-btn" id="stop-btn-buddha" aria-label="κ΄€μƒ μ¤‘λ‹¨ν•κ³  μ„¤μ •μΌλ΅ λμ•„κ°€κΈ°">μ¤‘λ‹¨</button>

                    <!-- Buddha Image with Dissolution -->
                    <div class="buddha-container" role="region" aria-label="λ¶μƒ κ΄€μƒ μ§„ν–‰">
                        <div class="buddha-stack dissolving" id="buddha-stack">
                            <div class="buddha-layer"></div>
                            <div class="buddha-layer"></div>
                            <div class="buddha-layer"></div>
                        </div>
                        <div class="buddha-timer-display" aria-live="polite" aria-atomic="true">
                            <span id="buddha-time-remaining">00:00</span>
                        </div>
                    </div>

                    <p class="meditation-instruction">λ¶μƒμ μ‚¬λΌμ§μ„ κ΄€μ°°ν•μ„Έμ”</p>
                </div>
            </div>

            <!-- 3. Buddha λ…μƒ μ™„λ£ ν™”λ©΄ -->
            <div id="screen-buddha-complete" class="screen center-content">
                <div class="center-box">
                    <h2 class="impermanence-text">λ¨λ“  ν•μ„±λ κ²ƒμ€ λ¬΄μƒν•λ‹¤</h2>
                    <button class="primary-btn" id="return-btn-buddha">λ‹¤μ‹ μ‹μ‘</button>
                </div>
            </div>
        </div>
        <!-- End Tab Panel: λ¶μƒ κ΄€μƒ -->

        <!-- Tab Panel: λ§λ‹¬λΌ (Mandala) -->
        <div id="tab-mandala" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-mandala">
            <div class="screen show">
                <div class="center-box">
                    <h2 class="coming-soon">μ¤€λΉ„ μ¤‘μ…λ‹λ‹¤</h2>
                </div>
            </div>
        </div>
        <!-- End Tab Panel: λ§λ‹¬λΌ -->

    </div>

    <!-- Floating Feedback Button -->
    <button class="fab fab-meditation" onclick="openFeedbackModal()" aria-label="ν”Όλ“λ°± λ‚¨κΈ°κΈ°">
        <span class="fab-icon">π’¬</span>
        <span class="fab-text">ν”Όλ“λ°±</span>
    </button>

    <script src="js/meditation.js"></script>
    <script src="js/feedback.js"></script>
</body>
</html>
